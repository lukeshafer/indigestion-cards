---
import { Api } from 'sst/node/api'
import Page from '@/layouts/Page.astro'
import Form, { inputClasses } from '@/components/form/Form.astro'
import InputBase from '@/components/form/InputBase.astro'
import { useUser } from '@/session'

const user = useUser(Astro.cookies)
if (!user) return Astro.redirect('/public')

const url = Api.api.url + '/create-card-season'
// TODO: Protect the API route
---

<Page
	title="Create New Season"
	session={user}
	breadcrumbs={[
		{ label: 'Home', href: '/' },
		{ label: 'Seasons', href: '/season' },
		{ label: 'New Season', href: '/create/season' },
	]}>
	<h1 class="page-heading">Create New Season</h1>

	<Form action={url}>
		<InputBase label="Season Name" id="name">
			<input id="name" name="name" type="text" class={inputClasses.input} />
		</InputBase>
		<InputBase label="Season ID" id="seasonId">
			<input
				id="seasonId"
				name="seasonId"
				type="text"
				data-id-from="name"
				data-edit-button
				readonly
				class={inputClasses.input}
				pattern="[a-z0-9-]+"
			/>
		</InputBase>
		<InputBase label="Description" id="description">
			<input type="text" id="description" name="description" class={inputClasses.input} />
		</InputBase>
		<button class={inputClasses.submit}>Create</button>
	</Form>
</Page>

<script></script>

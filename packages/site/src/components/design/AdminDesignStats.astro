---
import type { CardInstanceEntity, CardDesignEntity } from '@lil-indigestion-cards/core/card';
import DesignOverviewTable from './DesignOverviewTable.astro';
import RarityStatsTable from './RarityStatsTable.astro';
import { getRarityStatsOverviewFromDesignAndInstances } from '@lil-indigestion-cards/core/rarity';
import SubHeading from '../text/SubHeading.astro';

interface Props {
	design: CardDesignEntity;
	instances: CardInstanceEntity[];
}

const { design, instances } = Astro.props;

const rarityStatsArray = getRarityStatsOverviewFromDesignAndInstances(design, instances);
---

<div class="my-4 flex flex-col gap-8">
	<section class="grid text-lg">
		<SubHeading>Stats Overview</SubHeading>
		<DesignOverviewTable {rarityStatsArray} />
	</section>
	<section x-data="{ hideUnowned: false }">
		<header class="flex items-center gap-6">
			<SubHeading>Instance Breakdown</SubHeading>
			<div>
				<input
					type="checkbox"
					x-model="hideUnowned"
					id="hide-unowned"
					class="my-form-checkbox"
				/>
				<label for="hide-unowned">Hide Unowned</label>
			</div>
		</header>
		<ul>
			{rarityStatsArray.map((rarity) => <RarityStatsTable {...rarity} />)}
		</ul>
	</section>
</div>

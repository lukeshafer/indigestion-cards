---
import type { CardInstanceEntity, CardDesignEntity } from '@lil-indigestion-cards/core/card';
import DesignOverviewTable from './DesignOverviewTable.astro';
import RarityStatsTable from './RarityStatsTable.astro';
import { getRarityStatsOverviewFromDesignAndInstances } from '@lil-indigestion-cards/core/rarity';

interface Props {
	design: CardDesignEntity;
	instances: CardInstanceEntity[];
}

const { design, instances } = Astro.props;

const rarityStatsArray = getRarityStatsOverviewFromDesignAndInstances(design, instances);
---

<div class="flex flex-col gap-8 my-4">
	<section class="text-lg">
		<h2 class="sub-heading mb-4">Stats Overview</h2>
		<DesignOverviewTable {rarityStatsArray} />
	</section>
	<section x-data="{ hideUnowned: false }">
		<header class="flex items-center gap-6">
			<h2 class="sub-heading mb-4">Instance Breakdown</h2>
			<div>
				<input
					type="checkbox"
					x-model="hideUnowned"
					id="hide-unowned"
					class="my-form-checkbox"
				/>
				<label for="hide-unowned">Hide Unowned</label>
			</div>
		</header>
		<ul>
			{rarityStatsArray.map((rarity) => <RarityStatsTable {...rarity} />)}
		</ul>
	</section>
</div>

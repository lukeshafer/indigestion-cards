---
import { api } from '@/constants';
import SortTableRow from '@/components/table/SortTableRow.astro';
import SortTableCell from '@/components/table/SortTableCell.astro';

interface Props {
	username: string;
	userId: string;
	isStreamer: boolean;
}

const { username, userId, isStreamer } = Astro.props;

const isCurrentUser =
	Astro.locals.session?.type === 'admin' && Astro.locals.session?.properties.userId === userId;
---

<SortTableRow>
	<SortTableCell align="left" font="title">{username}</SortTableCell>
	<SortTableCell>
		<button
			class="post-button"
			class:list={{ 'opacity-0': isCurrentUser }}
			data-type="delete"
			disabled={isCurrentUser}
			hx-confirm="Are you sure you want to delete this user?"
			hx-post={api.ADMIN.DELETE}
			hx-vals={JSON.stringify({ userId, username, isStreamer })}
			hx-swap="outerHTML transition:false"
			hx-target="closest tr">
			Delete
		</button>
	</SortTableCell>
</SortTableRow>

---
import { routes } from '@/constants';
import Card from './cards/Card';

interface Props {
	cards: Parameters<typeof Card>[0][];
	showUsernames?: boolean;
}
const { cards, showUsernames } = Astro.props;

const Element = Astro.locals.session?.type === 'admin' ? 'a' : 'div';
---

<ul class="grid w-full justify-center justify-items-center gap-x-2 md:gap-x-6 gap-y-14 px-3">
	{
		cards.length > 0 ? (
			cards.map((card) => (
				<div class="w-fit">
					<Element
						rel="prefetch"
						href={`${routes.INSTANCES}/${card.designId}/${card.instanceId ?? ''}`}>
						<Card {...card} scale="var(--card-scale)" client:load />
					</Element>
					{showUsernames ? (
						<p class="mt-2">
							Owner:{' '}
							<a
								href={`${routes.USERS}/${card.username}`}
								class="font-bold hover:underline inline">
								{card.username}
							</a>
						</p>
					) : null}
				</div>
			))
		) : (
			<p>No cards found</p>
		)
	}
</ul>

<style>
	ul {
		grid-template-columns: repeat(auto-fill, minmax(calc(var(--card-scale) * 18rem), 1fr));
		--card-scale: 0.75;
	}

	@media (min-width: 640px) {
		ul {
			--card-scale: 1;
		}
	}
</style>

---
import Page from '@/layouts/Page.astro';
//import CardList from '@/components/CardList.astro';
import UnmatchedImageList from '@/components/UnmatchedImageList.astro';
import { getAllCardDesigns } from '@lil-indigestion-cards/core/card';
import { routes } from '@/constants';
import Card from '@/components/Card.astro';

const designs = await getAllCardDesigns();

const message = Astro.url.searchParams.get('message') || '';

const designsAndRarities = designs
	.map(
		(design) =>
			design.rarityDetails?.map((rarity) => ({
				rarityName: rarity.rarityName,
				frameUrl: rarity.frameUrl,
				designUrl: design.imgUrl,
				name: design.cardName,
				description: design.cardDescription,
			})) || []
	)
	.flat();

const breadcrumbs = [
	{ label: 'Home', href: '/' },
	{ label: 'Designs', href: routes.DESIGNS },
];
---

<Page title="All Cards Designs" breadcrumbs={breadcrumbs}>
	{message ? <p class="text-xl text-center p-4 bg-green-200">{message}</p> : null}
	<UnmatchedImageList type="cardDesign" />
	<header class="page-header">
		<h1 class="page-heading">All Card Designs</h1>
		<a href={routes.ADMIN.CREATE.CARD_DESIGN} class="button-link"> Create New Design</a>
	</header>
	<!--<CardList cards={designs} />-->
	{designsAndRarities.map((card) => <Card {...card} />)}
</Page>

---
import Page from '@/layouts/Page.astro';
import CardList from '@/components/CardList.astro';
import UnmatchedImageList from '@/components/UnmatchedImageList.astro';
import { getAllCardDesigns } from '@lil-indigestion-cards/core/card';
import { getSiteConfig } from '@lil-indigestion-cards/core/site-config';
import { routes } from '@/constants';

const [designs, siteConfig] = await Promise.all([getAllCardDesigns(), getSiteConfig()]);

const message = Astro.url.searchParams.get('message') || '';

const breadcrumbs = [
	{ label: 'Home', href: '/' },
	{ label: 'Designs', href: routes.DESIGNS },
];
---

<Page title="All Cards Designs" breadcrumbs={breadcrumbs}>
	{message ? <p class="text-xl text-center p-4 bg-green-200">{message}</p> : null}
	<UnmatchedImageList type="cardDesign" />
	<header class="page-header">
		<h1 class="page-heading">All Card Designs</h1>
		<a href={routes.ADMIN.CREATE.CARD_DESIGN} class="button-link"> Create New Design</a>
	</header>
	<CardList
		cards={designs.map((card) => ({
			name: card.cardName,
			description: card.cardDescription,
			designUrl: card.imgUrl,
			rarityName: siteConfig?.baseRarity.rarityId ?? '',
			frameUrl: siteConfig?.baseRarity.frameUrl ?? '',
			designId: card.designId,
			cardNumber: 1,
			totalOfType: 1,
		}))}
	/>
</Page>

---
import { deletePackTypeById } from '@lil-indigestion-cards/core/card';

const method = Astro.request.method.toUpperCase();
const body = await Astro.request.text();
const params = new URLSearchParams(body);

if (method !== 'DELETE') return new Response('Method not allowed', { status: 405 });

const packTypeId = params.get('packTypeId');
if (!packTypeId) return new Response('Missing packTypeId', { status: 400 });
const result = await deletePackTypeById({ packTypeId });
if (!result) return new Response('Failed to delete pack type', { status: 500 });
Astro.response.headers.set(
	'HX-Redirect',
	`/pack-type?alert=${
		result.success
			? 'Successfully deleted pack type&type=success'
			: 'Failed to delete pack type'
	}`
);
---

<body></body>

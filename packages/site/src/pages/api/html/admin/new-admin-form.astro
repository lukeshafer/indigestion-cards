---
import SortTableCell from '@/components/table/SortTableCell.astro';
import SortTableRow from '@/components/table/SortTableRow.astro';
import { api } from '@/constants';
import crypto from 'crypto';
const token = 'a' + crypto.randomBytes(2).toString('hex');
---

<body>
	<SortTableRow id={token} x-data="{ buttonText: 'Cancel' }">
		<SortTableCell align="left" font="title">
			<input
				id={`${token}-username`}
				type="text"
				name="username"
				@input="$el.value.length > 0 ? buttonText = 'Save' : buttonText = 'Cancel'"
				@keyup.enter="$dispatch('submit-admin')"
			/>
		</SortTableCell>
		<SortTableCell>
			<button
				@submit-admin.window="$dispatch('click')"
				class="post-button text-center"
				data-type="submit"
				x-text="buttonText"
				hx-post={api.ADMIN.CREATE}
				hx-target={`#${token}`}
				hx-swap="outerHTML"
				hx-include={`#${token}-username`}>
				Cancel</button
			>
		</SortTableCell>
	</SortTableRow>
</body>
<script>
	document.querySelector('button[hx-target=f]')?.dispatchEvent(new CustomEvent('submit-admin'));
</script>

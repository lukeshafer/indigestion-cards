---
import Page from '@/layouts/Page.astro'
import CardList from '@/components/CardList.astro'
import UnmatchedImageList from '@/components/UnmatchedImageList.astro'
import { getAllCardDesigns } from '@lil-indigestion-cards/core/card'
import { useUser } from '@/session'
import { routes } from '@/constants'

const user = useUser(Astro.cookies)
if (user?.type !== 'user') return Astro.redirect('/404')
const designs = await getAllCardDesigns()

const message = Astro.url.searchParams.get('message') || ''

const breadcrumbs = [
	{ label: 'Home', href: '/' },
	{ label: 'Designs', href: routes.DESIGNS },
]
---

<Page title="All Cards" class="flex flex-col gap-4" session={user} breadcrumbs={breadcrumbs}>
	{message ? <p class="text-xl text-center p-4 bg-green-200">{message}</p> : null}
	<UnmatchedImageList type="cardDesign" />
	<div class="flex flex-wrap gap-8">
		<h1 class="page-heading">All Card Designs</h1>
		<a
			href={routes.ADMIN.CREATE.CARD_DESIGN}
			class="text-xl bg-brand-tertiary p-3 px-4 text-center w-max font-display lowercase italic shine pt-4 text-shadow text-white">
			Create New Design
		</a>
	</div>
	<CardList cards={designs} session={user} />
</Page>

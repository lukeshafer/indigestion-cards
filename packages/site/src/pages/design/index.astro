---
import Page from '@/layouts/Page.astro';
import CardList from '@/components/CardList.astro';
import UnmatchedImageList from '@/components/UnmatchedImageList.astro';
import { getAllCardDesigns } from '@lil-indigestion-cards/core/card';
import { useAdmin } from '@/session';
import { routes } from '@/constants';

const admin = useAdmin(Astro.cookies);
if (!admin) return Astro.redirect('/404');
const designs = await getAllCardDesigns();

const message = Astro.url.searchParams.get('message') || '';

const breadcrumbs = [
	{ label: 'Home', href: '/' },
	{ label: 'Designs', href: routes.DESIGNS },
];
---

<Page title="All Cards" session={admin} breadcrumbs={breadcrumbs}>
	{message ? <p class="text-xl text-center p-4 bg-green-200">{message}</p> : null}
	<UnmatchedImageList type="cardDesign" />
	<header class="page-header">
		<h1 class="page-heading">All Card Designs</h1>
		<a
			href={routes.ADMIN.CREATE.CARD_DESIGN}
			class="button-link">
			Create New Design
		</a>
	</header>
	<CardList cards={designs} session={admin} />
</Page>

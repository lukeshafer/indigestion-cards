---
import Page from '@/layouts/Page.astro';
import { getAllAdminUsers } from '@lil-indigestion-cards/core/user';
import { routeNames } from '@/constants';
import PageHeading from '@/components/text/PageHeading.astro';
import PageHeader from '@/components/text/PageHeader.astro';
import AdminUsersTable, { AddAdminButton } from '@/components/admin-users/AdminUsersTable';

const unsortedUsers = await getAllAdminUsers();
const currentUser = Astro.locals.session?.properties?.userId;
const users = unsortedUsers.sort((a, b) => {
	if (a.userId === currentUser) {
		return -1;
	}
	if (b.userId === currentUser) {
		return 1;
	}
	return 0;
});
---

<Page title="Admin Users" breadcrumbs={[{ label: routeNames.ADMIN_USERS }]}>
	<PageHeader>
		<PageHeading>Admin Users</PageHeading>
		<AddAdminButton client:load />
	</PageHeader>
	<div class="mx-auto max-w-2xl">
		<AdminUsersTable {users} currentUser={currentUser ?? ''} client:load />
	</div>
</Page>

---
import Page from '@site/layouts/Page.astro';
import CardList from '@site/components/cards/CardList';
import { getAllCardDesigns } from '@core/lib/design';
import { routeNames } from '@site/constants';
import { PageTitle, PageHeader } from '@site/components/text';

const designs = getAllCardDesigns();
const filters = [...Astro.url.searchParams.entries()];
---

<Page title="All Cards" breadcrumbs={[{ label: routeNames.CARDS }]} pageType="public">
	<PageHeader>
		<PageTitle>All Cards</PageTitle>
	</PageHeader>
	{
		designs.then(designs => (
			<CardList
				client:load
				{filters}
				cards={designs.map(card => {
					const bestRarity = card.bestRarityFound;

					return {
						...card,
						rarityName: bestRarity?.rarityName ?? '',
						rarityId: bestRarity?.rarityId ?? '',
						frameUrl: bestRarity?.frameUrl ?? '',
						rarityColor: bestRarity?.rarityColor ?? '',
						totalOfType: bestRarity?.count ?? 1,
						cardNumber: 1,
					};
				})}
				sortOnlyBy={['card-name-asc', 'card-name-desc']}
			/>
		))
	}
</Page>

---
import { api } from '@/constants';
import Page from '@/layouts/Page.astro';
import { getAllPacks } from '@lil-indigestion-cards/core/card';

const packs = await getAllPacks();
---

<Page title="All Packs" breadcrumbs={[{label: "Home", href: "/" }, {label: "Packs"}]}>
	<header class="page-header">
		<h1 class="page-heading">All Packs</h1>
	</header>
	<sort-table>
		<table x-data="{}">
			<thead>
				<tr>
					<th class="w-1/2">Owner</th>
					<th>Pack Type</th>
					<th></th>
				</tr>
			</thead>
			<tbody>
				{
					packs.map((pack) => {
						const id = pack.packId.replace(/[^\w\d]/g, '') + '-username';
						return (
							<tr>
								{pack.username ? (
									<td>
										<span {id}>
											{pack.username}
										</span>
									</td>
								) : (
									<td class="text-gray-600">None</td>
								)}
								<td>{pack.packTypeName}</td>
								<td>
									<button
										class="post-button"
										data-type="submit"
										hx-swap="outerHTML"
										hx-vals={JSON.stringify({
											id,
											username: pack.username,
											packId: pack.packId,
										})}
										hx-get={api.PACK.START_EDIT}>
										Edit
									</button>
								</td>
							</tr>
						);
					})
				}
			</tbody>
		</table>
	</sort-table>
</Page>

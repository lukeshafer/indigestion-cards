---
import Page from '@/layouts/Page.astro';
import OpenPacksComponent from '@/components/open-packs/OpenPacks';
import { getAllPacks } from '@lil-indigestion-cards/core/card';

const allPacks = await getAllPacks();
const packs = allPacks
	.filter((pack) => pack.userId && pack.username)
	.sort((a, b) => (a.createdAt ?? 0) - (b.createdAt ?? 0));

const startMargin = Astro.cookies.get('openPacksMargin')?.value;
const startCardScale = Astro.cookies.get('openPacksScale')?.value;
---

<Page title="Open Packs" breadcrumbs={[{ label: 'Open Packs' }]} wide>
	<OpenPacksComponent
		packs={packs}
		canTest={process.env.SST_STAGE === 'dev' || process.env.SST_STAGE === 'luke'}
		startMargin={startMargin ? parseInt(startMargin) : undefined}
		startCardScale={startCardScale ? Number(startCardScale) : undefined}
		client:load
	/>
</Page>

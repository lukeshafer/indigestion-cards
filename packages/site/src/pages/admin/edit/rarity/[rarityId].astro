---
import Page from '@/layouts/Page.astro';
import { api, routes } from '@/constants';
import RarityForm from '@/components/entity-forms/RarityForm.astro';
import { getRarityById } from '@lil-indigestion-cards/core/card';

const rarityId = Astro.params.rarityId;

if (!rarityId) {
	return Astro.redirect('/?alert=Please provide a rarity ID');
}

const rarity = await getRarityById({ rarityId });

if (!rarity) {
	return Astro.redirect('/?alert=Invalid rarity ID');
}
---

<Page
	title="Edit Rarity"
	breadcrumbs={[
		{ label: 'Home', href: '/' },
		{ label: 'Rarities', href: '/rarity' },
		{ label: 'Edit', href: `/admin/edit/rarity/${rarityId}` },
	]}>
	<h1 class="page-heading">Add Rarity</h1>
	<div class="flex flex-col pt-8 gap-8 max-w-4xl">
		<div>
			<img src={rarity.frameUrl} class="w-60 h-auto object-contain mb-4" />
		</div>

		<RarityForm action={`${api.UPDATE_RARITY}?redirect=${routes.RARITIES}`} rarity={rarity} />
	</div>
</Page>
